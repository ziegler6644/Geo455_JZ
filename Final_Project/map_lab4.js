var atlIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'atlanta-hawks-logo-transparent.png'
 });
var bosIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Boston_Celtics.svg.png'
 });
var brkIcon = new L.Icon({
     iconSize: [25, 25],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: '1200px-Brooklyn_Nets_newlogo.svg.png'
 });
var cltIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Charlotte_Hornets_(2014).svg.png'
 });
var chiIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Chicago_Bulls_logo.svg.png'
 });
var cleIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: '58419c8da6515b1e0ad75a63.png'
 });
var dalIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Dallas_Mavericks_logo.svg.png'
 });
var denIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Denver_Nuggets.svg.png'
 });
var detIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: '1200px-Pistons_logo17.svg.png'
 });
var gswIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Golden_State_Warriors_logo.svg.webp'
 });
var houIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Houston_Rockets.svg.png'
 });
var indIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Indiana_Pacers.svg.png'
 });
var lacIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'LA_Clippers_logo_logotype_emblem.png'
 });
var lalIcon = new L.Icon({
     iconSize: [25, 25],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: '1200px-Los_Angeles_Lakers_logo.svg.webp'
 });
var memIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: '795.png'
 });
var memIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: '795.png'
 });
var miaIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Miami_Heat_logo.svg.png'
 });
var milIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Milwaukee_Bucks_logo.svg.png'
 });
var minIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Minnesota_Timberwolves_logo.svg'
 });
var nopIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'New_Orleans_Pelicans_logo.svg.png'
 });
var nykIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'New_York_Knicks_logo.svg.png'
 });
var orlIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Orlando_Magic_logo.svg.png'
 });
var okcIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Oklahoma_City_Thunder.svg.png'
 });
var phiIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Philadelphia_76ers_logo.svg.png'
 });
var phoIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Phoenix_Suns_logo.svg.png'
 });
var porIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Portland_Trail_Blazers_logo.svg.png'
 });
var sacIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'SacramentoKings.svg.png'
 });
var sasIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'San_Antonio_Spurs.svg.png'
 });
var torIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Toronto_Raptors_logo.svg.png'
 });
var utaIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Utah_Jazz_logo_2022.svg (1).png'
 });
var wizIcon = new L.Icon({
     iconSize: [35, 35],
     iconAnchor: [10, 15],
     popupAnchor:  [1, -24],
     iconUrl: 'Washington_Wizards_logo.svg.png'
 });
var greatwallPopup = "State Farm Arena<br/><img src='https://upload.wikimedia.org/wikipedia/commons/e/e2/State_Farm_%28Phillips%29_Arena%2C_Atlanta%2C_GA_%2846558861525%29.jpg' alt='great wall wiki' width='150px'/>";

var ChichenItzaPopup = "TD Garden<br/><img src='https://upload.wikimedia.org/wikipedia/commons/6/6a/TD_Garden_%28crop%29.JPG' alt='Chichen-Itza wiki' width='150px'/>";

var PetraPopup = "Barclays Center<br/><img src='https://upload.wikimedia.org/wikipedia/commons/d/df/BarclayCenter-2_%2848034233762%29.jpg' alt='Petra wiki' width='150px'/>";

var MachuPichuPopup = "Spectrum Center<br/><img src='https://upload.wikimedia.org/wikipedia/commons/6/6e/Spectrum_Center_2018.jpg' alt='MachuPichu wiki' width='150px'/>";

var ChristtheRedeemerPopup = "United Center<br/><img src='https://upload.wikimedia.org/wikipedia/commons/2/22/United_Center_1.jpg' alt='Christ the Redeemer wiki' width='150px'/>";

var ColosseumPopup = "Rocket Mortgage Field House<br/><img src='https://upload.wikimedia.org/wikipedia/commons/f/fd/Rocket_Mortgage_FieldHouse_%282%29.jpg' alt='Colosseum wiki' width='150px'/>";

var TajMahalPopup = "American Airlines Center<br/><img src='https://upload.wikimedia.org/wikipedia/commons/3/3d/American_Airlines_Center_%286246886325%29_cropped.jpg' alt='Taj Mahal wiki' width='150px'/>";

var customOptions ={'maxWidth': '150','className' : 'custom'};

// Set up landmark variables and individual landmarks
var landmarks = L.layerGroup();

var greatwall = L.marker([33.757225,-84.396442],{icon: atlIcon}).bindPopup(greatwallPopup, customOptions).addTo(landmarks);

var Chichen = L.marker([42.366286,-71.062102],{icon: bosIcon}).bindPopup(ChichenItzaPopup, customOptions).addTo(landmarks);

var Petra = L.marker([40.682635, -73.975167],{icon: brkIcon}).bindPopup(PetraPopup, customOptions).addTo(landmarks);

var Machu = L.marker([35.225163,-80.839289],{icon: cltIcon}).bindPopup(MachuPichuPopup, customOptions).addTo(landmarks);

var Christ = L.marker([41.880553,-87.674039],{icon: chiIcon}).bindPopup(ChristtheRedeemerPopup, customOptions).addTo(landmarks);

var Coll = L.marker([41.496643,-81.688152],{icon: cleIcon}).bindPopup(ColosseumPopup, customOptions).addTo(landmarks);

var Taj = L.marker([32.790467,-96.8103],{icon: dalIcon}).bindPopup(TajMahalPopup, customOptions).addTo(landmarks);

var greatwall = L.marker([39.748720,-105.007651],{icon: denIcon}).bindPopup(greatwallPopup, customOptions).addTo(landmarks);

var Chichen = L.marker([42.341275, -83.055110],{icon: detIcon}).bindPopup(ChichenItzaPopup, customOptions).addTo(landmarks);

var Petra = L.marker([37.767881, -122.387370],{icon: gswIcon}).bindPopup(PetraPopup, customOptions).addTo(landmarks);

var Machu = L.marker([29.750774,-95.362101],{icon: houIcon}).bindPopup(MachuPichuPopup, customOptions).addTo(landmarks);

var Christ = L.marker([39.763973,-86.155437],{icon: indIcon}).bindPopup(ChristtheRedeemerPopup, customOptions).addTo(landmarks);

var Coll = L.marker([34.043065,-118.267234],{icon: lacIcon}).bindPopup(ColosseumPopup, customOptions).addTo(landmarks);

var Taj = L.marker([34.043065,-118.267234],{icon: lalIcon}).bindPopup(TajMahalPopup, customOptions).addTo(landmarks);

var greatwall = L.marker([35.138211,-90.050452],{icon: memIcon}).bindPopup(greatwallPopup, customOptions).addTo(landmarks);

var Chichen = L.marker([25.781412,-80.188015],{icon: miaIcon}).bindPopup(ChichenItzaPopup, customOptions).addTo(landmarks);

var Petra = L.marker([43.045044, -87.917338],{icon: milIcon}).bindPopup(PetraPopup, customOptions).addTo(landmarks);

var Machu = L.marker([44.979556,-93.276161],{icon: minIcon}).bindPopup(MachuPichuPopup, customOptions).addTo(landmarks);

var Christ = L.marker([29.949032,-90.082082],{icon: nopIcon}).bindPopup(ChristtheRedeemerPopup, customOptions).addTo(landmarks);

var Coll = L.marker([40.750436,-73.99331],{icon: nykIcon}).bindPopup(ColosseumPopup, customOptions).addTo(landmarks);

var Taj = L.marker([28.539248,-81.383874],{icon: orlIcon}).bindPopup(TajMahalPopup, customOptions).addTo(landmarks);

var greatwall = L.marker([35.463430,-97.515077],{icon: okcIcon}).bindPopup(greatwallPopup, customOptions).addTo(landmarks);

var Chichen = L.marker([39.901154,-75.171995],{icon: phiIcon}).bindPopup(ChichenItzaPopup, customOptions).addTo(landmarks);

var Petra = L.marker([33.445812,-112.071161],{icon: phoIcon}).bindPopup(PetraPopup, customOptions).addTo(landmarks);

var Machu = L.marker([45.531539,-122.666669],{icon: porIcon}).bindPopup(MachuPichuPopup, customOptions).addTo(landmarks);

var Christ = L.marker([38.580396, -121.499671],{icon: sacIcon}).bindPopup(ChristtheRedeemerPopup, customOptions).addTo(landmarks);

var Coll = L.marker([29.427002,-98.437468],{icon: sasIcon}).bindPopup(ColosseumPopup, customOptions).addTo(landmarks);

var Taj = L.marker([43.64346,-79.379072],{icon: torIcon}).bindPopup(TajMahalPopup, customOptions).addTo(landmarks);

var Coll = L.marker([40.768271,-111.901194],{icon: utaIcon}).bindPopup(ColosseumPopup, customOptions).addTo(landmarks);

var Taj = L.marker([38.898073,-77.020934],{icon: wizIcon}).bindPopup(TajMahalPopup, customOptions).addTo(landmarks);









//Set up the baselayers and WMS layer

var streets = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZ2NoYXVkaHVyaSIsImEiOiJjazBtcG5odG8wMDltM2JtcjdnYTgyanBnIn0.qwqjMomdrBMG36GQKXBlMw', {
 maxZoom: 18,
 attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
 'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
 id: 'mapbox/streets-v11',
 tileSize: 512,
 zoomOffset: -1
});

var grayscale = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZ2NoYXVkaHVyaSIsImEiOiJjazBtcG5odG8wMDltM2JtcjdnYTgyanBnIn0.qwqjMomdrBMG36GQKXBlMw', {
 maxZoom: 18,
 attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
 'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
 id: 'mapbox/light-v9',
 tileSize: 512,
 zoomOffset: -1
});

var topo = L.tileLayer.wms('http://ows.mundialis.de/services/service?', {
 layers: 'SRTM30-Colored-Hillshade'
});

//Create the map variable

var mymap = L.map("map", {
 center: [38.85250119246977, -99.60815961021089], 
 zoom: 4,
 layers: [grayscale, landmarks]});

// Create menu items
var baseLayers = {
 'Grayscale': grayscale,
 'Streets': streets,
 "Hillshade": topo,
 };



function getColor(value) {
    return value > 15 ? '#54278f':
           value > 5  ? '#756bb1':
           value > 3  ? '#9e9ac8':
           value > 1  ? '#cbc9e2':
                         '#f2f0f7';
}

function style(feature){
    return {
        fillColor: getColor(feature.properties.Count_of_State__NBA_Finals_and_MVP___Copy_csv_),   // pop_den is the field name for the population density data
        weight: 2,
        opacity: 1,
        color: 'gray',
        fillOpacity: 0.9
    };
    }

  function highlightFeature(e) {
    // Get access to the feature that was hovered through e.target
    var feature = e.target;

    // Set a thick grey border on the feature as mouseover effect
    // Adjust the values below to change the highlighting styles of features on mouseover
    // Check out https://leafletjs.com/reference-1.3.4.html#path for more options for changing style
    feature.setStyle({
        weight: 5,
        color: '#666',
        fillOpacity: 0.7
    });

    // Bring the highlighted feature to front so that the border doesn’t clash with nearby states
    // But not for IE, Opera or Edge, since they have problems doing bringToFront on mouseover
    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
        feature.bringToFront();
    }
}

    function onEachFeature(feature, layer) {
        layer.on({
            mouseover: highlightFeature, // Do what defined by the highlightFeature function on mouseover
            mouseout: resetHighlight,    // Do what defined by the resetHighlight function on mouseout
        });
    }


    var geojson; // define a variable to make the geojson layer accessible for the funtion to use   

    function resetHighlight(e) {
        geojson.resetStyle(e.target);
    }

    geojson = L.geoJson(data, {
        style: style,
        onEachFeature: onEachFeature
    }).bindPopup(function (layer){
    return layer.feature.properties.name
           + '<p style="color:purple">' + layer.feature.properties.Count_of_State__NBA_Finals_and_MVP___Copy_csv_.toString() + ' Championships </p>';       
}).addTo(mymap);

function getRadius(area) {
  var radius = Math.sqrt(area/Math.PI);
  return radius * 2;
}

var propcircles = new L.geoJson(points, {
    onEachFeature: function(feature, featureLayer){
        featureLayer.bindPopup('<p> state: <b>'+feature.properties.State+ '</b></br>' +
                               'Players: '+feature.properties.F__of_Players+'</p>');
    },
    pointToLayer: function(feature, latlng) {
      return L.circleMarker(latlng, {
          fillColor: "#920101", 
          color: '#920101',
          weight: 2,       
          radius: getRadius(feature.properties.F__of_Players),
          fillOpacity: .35
      }).on({
            mouseover: function(e) {
                this.openPopup();
                this.setStyle({fillOpacity: .8, fillColor: '#2D8F4E'});

            },
            mouseout: function(e) {
                this.closePopup();
                this.setStyle({fillOpacity: .35, fillColor: '#920101'});  
            }
    });
  }
}).addTo(mymap);

  var legend = L.control({position: 'bottomright'}); // Try the other three corners if you like.

    legend.onAdd = function (mymap) {

        var div = L.DomUtil.create('div', 'legend'),
            grades = [0, 32, 53, 87, 139]; // The break values to define the intervals of population, note we begin from 0 here

        div.innerHTML = '<b>Population Density <br></b>'; // The legend title (HTML-based), in this case it's Population Density 2011

        // Loop through our the classes and generate a label with a color box for each interval.
        // If you are creating a choropleth map, you DO NOT need to change lines below.
        for (var i = 0; i < grades.length; i++) {
            div.innerHTML +=
            '<i style="background:' + getColor(grades[i] + 1) + '"></i>' +
            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
        }

        return div;
    };


    legend.addTo(mymap);
 var overlays = {'Landmarks': landmarks,
                'Players': propcircles,
               
               };
var layerControl = L.control.layers(baseLayers, overlays, {collapsed: false}).addTo(mymap);